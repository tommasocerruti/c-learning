#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <stdio.h>

#define MAXLW 20
#define MAXNW 100

typedef struct{
    char word[MAXLW];
    int occ;
}index_t;

void read_words(index_t *, int *, char *);
void read_text(index_t *, int, char *);
int compare(char *, char *);
void print_results(index_t *, int);

// DISCLAIMER:
// Before compiling do the following procedure to run the program
// Run --> Edit Configuration --> Program arguments --> text.txt words.txt
// Move the text files from "files" to "cmake-build-debug"
// Run the code!

int main(int argc, char *argv[]) {
    int n=0;
    index_t indices[MAXNW];
    read_words(indices,&n,argv[1]);
    read_text(indices, n, argv[2]);
    print_results(indices,n);
    return EXIT_SUCCESS;
}

void read_words(index_t *indices, int *n, char *input){
    FILE *fp;
    if ((fp=fopen(input, "r"))==NULL){
        fprintf(stderr,"Error opening file %s",input);
        exit(1);
    }
    while (fscanf(fp,"%s",indices[*n].word)!=EOF && (*n)<MAXNW){
        indices[*n].occ=0;
        (*n)++;
    }
    fclose(fp);
}

void read_text(index_t *indices, int n, char *input){
    FILE *fp;
    int i;
    char word[MAXLW];
    if ((fp=fopen(input, "r"))==NULL){
        fprintf(stderr,"Error opening file %s",input);
        exit(1);
    }
    while (fscanf(fp,"%s",word)!=EOF){
        for (i=0;i<n;i++){
            if (compare(word,indices[i].word)==1)
                indices[i].occ++;
        }
    }
    fclose(fp);
}

int compare(char *s1, char *s2){
    int i;
    if (strlen(s1)!=strlen(s2))
        return 0;
    else{
        for (i=0;i<strlen(s1);i++){
            if (tolower(s1[i])!=tolower(s2[i]))
                return 0;
        }
    }
    return 1;
}

void print_results(index_t *indices, int n){
    int i;
    for (i=0;i<n;i++)
        fprintf(stdout, "%s: %d occurence(s)\n", indices[i].word, indices[i].occ);
}